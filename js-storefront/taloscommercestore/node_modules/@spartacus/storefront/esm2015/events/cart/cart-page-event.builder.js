import { Injectable } from '@angular/core';
import { ActionsSubject } from '@ngrx/store';
import { createFrom, EventService, FeatureConfigService, } from '@spartacus/core';
import { filter, map } from 'rxjs/operators';
import { NavigationEvent } from '../navigation/navigation.event';
import { CartPageEvent } from './cart-page.events';
import * as i0 from "@angular/core";
import * as i1 from "@ngrx/store";
import * as i2 from "@spartacus/core";
export class CartPageEventBuilder {
    constructor(
    // TODO: #10896 - remove this
    /** @deprecated @since 3.1 - this will be removed in 4.0 */
    actions, eventService, 
    // TODO: #10896 - remove this
    /** @deprecated @since 3.1 - this will be removed in 4.0 */ featureConfigService) {
        this.actions = actions;
        this.eventService = eventService;
        this.featureConfigService = featureConfigService;
        this.register();
    }
    register() {
        this.eventService.register(CartPageEvent, this.buildCartPageEvent());
    }
    buildCartPageEvent() {
        return this.eventService.get(NavigationEvent).pipe(filter((navigationEvent) => navigationEvent.semanticRoute === 'cart'), map((navigationEvent) => createFrom(CartPageEvent, Object.assign(Object.assign({}, this.createDeprecatedPageEvent(navigationEvent)), { navigation: Object.assign({}, navigationEvent) }))));
    }
    // TODO: #10896 - remove this method
    createDeprecatedPageEvent(navigationEvent) {
        if (!this.featureConfigService ||
            this.featureConfigService.isLevel('!3.1')) {
            return Object.assign({}, navigationEvent);
        }
        return undefined;
    }
}
CartPageEventBuilder.ɵprov = i0.ɵɵdefineInjectable({ factory: function CartPageEventBuilder_Factory() { return new CartPageEventBuilder(i0.ɵɵinject(i1.ActionsSubject), i0.ɵɵinject(i2.EventService), i0.ɵɵinject(i2.FeatureConfigService)); }, token: CartPageEventBuilder, providedIn: "root" });
CartPageEventBuilder.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root',
            },] }
];
CartPageEventBuilder.ctorParameters = () => [
    { type: ActionsSubject },
    { type: EventService },
    { type: FeatureConfigService }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FydC1wYWdlLWV2ZW50LmJ1aWxkZXIuanMiLCJzb3VyY2VSb290IjoiQzovVXNlcnMvUGF0cnlrL0Rlc2t0b3Avc3BhcnRhY3VzL3Byb2plY3RzL3N0b3JlZnJvbnRsaWIvc3JjLyIsInNvdXJjZXMiOlsiZXZlbnRzL2NhcnQvY2FydC1wYWdlLWV2ZW50LmJ1aWxkZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBQzdDLE9BQU8sRUFDTCxVQUFVLEVBQ1YsWUFBWSxFQUNaLG9CQUFvQixHQUNyQixNQUFNLGlCQUFpQixDQUFDO0FBRXpCLE9BQU8sRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDN0MsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBRWpFLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQzs7OztBQUtuRCxNQUFNLE9BQU8sb0JBQW9CO0lBQy9CO0lBQ0UsNkJBQTZCO0lBQzdCLDJEQUEyRDtJQUNqRCxPQUF1QixFQUN2QixZQUEwQjtJQUNwQyw2QkFBNkI7SUFDN0IsMkRBQTJELENBQVcsb0JBQTJDO1FBSHZHLFlBQU8sR0FBUCxPQUFPLENBQWdCO1FBQ3ZCLGlCQUFZLEdBQVosWUFBWSxDQUFjO1FBRWtDLHlCQUFvQixHQUFwQixvQkFBb0IsQ0FBdUI7UUFFakgsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ2xCLENBQUM7SUFFUyxRQUFRO1FBQ2hCLElBQUksQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLGFBQWEsRUFBRSxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxDQUFDO0lBQ3ZFLENBQUM7SUFFUyxrQkFBa0I7UUFDMUIsT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsQ0FBQyxJQUFJLENBQ2hELE1BQU0sQ0FBQyxDQUFDLGVBQWUsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLGFBQWEsS0FBSyxNQUFNLENBQUMsRUFDckUsR0FBRyxDQUFDLENBQUMsZUFBZSxFQUFFLEVBQUUsQ0FDdEIsVUFBVSxDQUFDLGFBQWEsa0NBQ25CLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxlQUFlLENBQUMsS0FDbEQsVUFBVSxvQkFDTCxlQUFlLEtBRXBCLENBQ0gsQ0FDRixDQUFDO0lBQ0osQ0FBQztJQUVELG9DQUFvQztJQUM1Qix5QkFBeUIsQ0FDL0IsZUFBZ0M7UUFFaEMsSUFDRSxDQUFDLElBQUksQ0FBQyxvQkFBb0I7WUFDMUIsSUFBSSxDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFDekM7WUFDQSx5QkFBWSxlQUFlLEVBQUc7U0FDL0I7UUFDRCxPQUFPLFNBQVMsQ0FBQztJQUNuQixDQUFDOzs7O1lBNUNGLFVBQVUsU0FBQztnQkFDVixVQUFVLEVBQUUsTUFBTTthQUNuQjs7O1lBZFEsY0FBYztZQUdyQixZQUFZO1lBQ1osb0JBQW9CIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQWN0aW9uc1N1YmplY3QgfSBmcm9tICdAbmdyeC9zdG9yZSc7XG5pbXBvcnQge1xuICBjcmVhdGVGcm9tLFxuICBFdmVudFNlcnZpY2UsXG4gIEZlYXR1cmVDb25maWdTZXJ2aWNlLFxufSBmcm9tICdAc3BhcnRhY3VzL2NvcmUnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZmlsdGVyLCBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBOYXZpZ2F0aW9uRXZlbnQgfSBmcm9tICcuLi9uYXZpZ2F0aW9uL25hdmlnYXRpb24uZXZlbnQnO1xuaW1wb3J0IHsgUGFnZUV2ZW50IH0gZnJvbSAnLi4vcGFnZS9wYWdlLmV2ZW50cyc7XG5pbXBvcnQgeyBDYXJ0UGFnZUV2ZW50IH0gZnJvbSAnLi9jYXJ0LXBhZ2UuZXZlbnRzJztcblxuQEluamVjdGFibGUoe1xuICBwcm92aWRlZEluOiAncm9vdCcsXG59KVxuZXhwb3J0IGNsYXNzIENhcnRQYWdlRXZlbnRCdWlsZGVyIHtcbiAgY29uc3RydWN0b3IoXG4gICAgLy8gVE9ETzogIzEwODk2IC0gcmVtb3ZlIHRoaXNcbiAgICAvKiogQGRlcHJlY2F0ZWQgQHNpbmNlIDMuMSAtIHRoaXMgd2lsbCBiZSByZW1vdmVkIGluIDQuMCAqL1xuICAgIHByb3RlY3RlZCBhY3Rpb25zOiBBY3Rpb25zU3ViamVjdCxcbiAgICBwcm90ZWN0ZWQgZXZlbnRTZXJ2aWNlOiBFdmVudFNlcnZpY2UsXG4gICAgLy8gVE9ETzogIzEwODk2IC0gcmVtb3ZlIHRoaXNcbiAgICAvKiogQGRlcHJlY2F0ZWQgQHNpbmNlIDMuMSAtIHRoaXMgd2lsbCBiZSByZW1vdmVkIGluIDQuMCAqLyBwcm90ZWN0ZWQgZmVhdHVyZUNvbmZpZ1NlcnZpY2U/OiBGZWF0dXJlQ29uZmlnU2VydmljZVxuICApIHtcbiAgICB0aGlzLnJlZ2lzdGVyKCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgcmVnaXN0ZXIoKTogdm9pZCB7XG4gICAgdGhpcy5ldmVudFNlcnZpY2UucmVnaXN0ZXIoQ2FydFBhZ2VFdmVudCwgdGhpcy5idWlsZENhcnRQYWdlRXZlbnQoKSk7XG4gIH1cblxuICBwcm90ZWN0ZWQgYnVpbGRDYXJ0UGFnZUV2ZW50KCk6IE9ic2VydmFibGU8Q2FydFBhZ2VFdmVudD4ge1xuICAgIHJldHVybiB0aGlzLmV2ZW50U2VydmljZS5nZXQoTmF2aWdhdGlvbkV2ZW50KS5waXBlKFxuICAgICAgZmlsdGVyKChuYXZpZ2F0aW9uRXZlbnQpID0+IG5hdmlnYXRpb25FdmVudC5zZW1hbnRpY1JvdXRlID09PSAnY2FydCcpLFxuICAgICAgbWFwKChuYXZpZ2F0aW9uRXZlbnQpID0+XG4gICAgICAgIGNyZWF0ZUZyb20oQ2FydFBhZ2VFdmVudCwge1xuICAgICAgICAgIC4uLnRoaXMuY3JlYXRlRGVwcmVjYXRlZFBhZ2VFdmVudChuYXZpZ2F0aW9uRXZlbnQpLFxuICAgICAgICAgIG5hdmlnYXRpb246IHtcbiAgICAgICAgICAgIC4uLm5hdmlnYXRpb25FdmVudCxcbiAgICAgICAgICB9LFxuICAgICAgICB9KVxuICAgICAgKVxuICAgICk7XG4gIH1cblxuICAvLyBUT0RPOiAjMTA4OTYgLSByZW1vdmUgdGhpcyBtZXRob2RcbiAgcHJpdmF0ZSBjcmVhdGVEZXByZWNhdGVkUGFnZUV2ZW50KFxuICAgIG5hdmlnYXRpb25FdmVudDogTmF2aWdhdGlvbkV2ZW50XG4gICk6IFBhZ2VFdmVudCB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKFxuICAgICAgIXRoaXMuZmVhdHVyZUNvbmZpZ1NlcnZpY2UgfHxcbiAgICAgIHRoaXMuZmVhdHVyZUNvbmZpZ1NlcnZpY2UuaXNMZXZlbCgnITMuMScpXG4gICAgKSB7XG4gICAgICByZXR1cm4geyAuLi5uYXZpZ2F0aW9uRXZlbnQgfTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuIl19