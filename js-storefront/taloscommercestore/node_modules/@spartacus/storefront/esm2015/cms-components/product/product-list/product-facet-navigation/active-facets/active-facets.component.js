import { ChangeDetectionStrategy, Component, Input } from '@angular/core';
import { ICON_TYPE } from '../../../../../cms-components/misc/icon/icon.model';
import { FacetService } from '../services/facet.service';
/**
 * Active facets render the applied facet values as a list of focusable buttons
 * which can be used to remove the applied facet value.
 */
export class ActiveFacetsComponent {
    constructor(facetService) {
        this.facetService = facetService;
        /** Active facets which are applied to the product results. */
        this.facetList$ = this.facetService.facetList$;
        /** Configurable icon which is used for the active facet close button */
        this.closeIcon = ICON_TYPE.CLOSE;
    }
    getLinkParams(facet) {
        var _a, _b;
        return this.facetService.getLinkParams((_b = (_a = facet.removeQuery) === null || _a === void 0 ? void 0 : _a.query) === null || _b === void 0 ? void 0 : _b.value);
    }
    /**
     * The focus key is used to persist the focus on the facet when the DOM is being
     * recreated. We only apply the focus key for the given _active_ facet when there
     * the original facets is not available. This happens for non multi-valued facets.
     *
     * With this approach, the we keep the focus, either at the facet list or on the
     * active facets.
     */
    getFocusKey(facetList, facet) {
        var _a;
        return ((_a = facetList.facets) === null || _a === void 0 ? void 0 : _a.find((f) => { var _a; return (_a = f.values) === null || _a === void 0 ? void 0 : _a.find((val) => val.name === facet.facetValueName); })) ? ''
            : facet.facetValueName;
    }
}
ActiveFacetsComponent.decorators = [
    { type: Component, args: [{
                selector: 'cx-active-facets',
                template: "<ng-container *ngIf=\"facetList$ | async as facetList\">\n  <h4 *ngIf=\"facetList?.activeFacets?.length > 0\">\n    {{ 'productList.appliedFilter' | cxTranslate }}\n  </h4>\n\n  <a\n    *ngFor=\"let facet of facetList?.activeFacets\"\n    routerLink=\"./\"\n    [queryParams]=\"getLinkParams(facet)\"\n    [cxFocus]=\"getFocusKey(facetList, facet)\"\n  >\n    <span>{{ facet.facetValueName }}</span>\n    <cx-icon aria-hidden=\"true\" [type]=\"closeIcon\"></cx-icon>\n  </a>\n</ng-container>\n",
                changeDetection: ChangeDetectionStrategy.Default
            },] }
];
ActiveFacetsComponent.ctorParameters = () => [
    { type: FacetService }
];
ActiveFacetsComponent.propDecorators = {
    closeIcon: [{ type: Input }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWN0aXZlLWZhY2V0cy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiQzovVXNlcnMvUGF0cnlrL0Rlc2t0b3Avc3BhcnRhY3VzL3Byb2plY3RzL3N0b3JlZnJvbnRsaWIvc3JjLyIsInNvdXJjZXMiOlsiY21zLWNvbXBvbmVudHMvcHJvZHVjdC9wcm9kdWN0LWxpc3QvcHJvZHVjdC1mYWNldC1uYXZpZ2F0aW9uL2FjdGl2ZS1mYWNldHMvYWN0aXZlLWZhY2V0cy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLHVCQUF1QixFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFHMUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLG9EQUFvRCxDQUFDO0FBRS9FLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUV6RDs7O0dBR0c7QUFNSCxNQUFNLE9BQU8scUJBQXFCO0lBT2hDLFlBQXNCLFlBQTBCO1FBQTFCLGlCQUFZLEdBQVosWUFBWSxDQUFjO1FBTmhELDhEQUE4RDtRQUM5RCxlQUFVLEdBQTBCLElBQUksQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDO1FBRWpFLHdFQUF3RTtRQUMvRCxjQUFTLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQztJQUVjLENBQUM7SUFFcEQsYUFBYSxDQUFDLEtBQWlCOztRQUM3QixPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsYUFBYSxhQUFDLEtBQUssQ0FBQyxXQUFXLDBDQUFFLEtBQUssMENBQUUsS0FBSyxDQUFDLENBQUM7SUFDMUUsQ0FBQztJQUVEOzs7Ozs7O09BT0c7SUFDSCxXQUFXLENBQUMsU0FBb0IsRUFBRSxLQUFpQjs7UUFDakQsT0FBTyxPQUFBLFNBQVMsQ0FBQyxNQUFNLDBDQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLHdCQUNsQyxDQUFDLENBQUMsTUFBTSwwQ0FBRSxJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEtBQUssS0FBSyxDQUFDLGNBQWMsSUFBQyxHQUUxRCxDQUFDLENBQUMsRUFBRTtZQUNKLENBQUMsQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDO0lBQzNCLENBQUM7OztZQWhDRixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLGtCQUFrQjtnQkFDNUIseWZBQTZDO2dCQUM3QyxlQUFlLEVBQUUsdUJBQXVCLENBQUMsT0FBTzthQUNqRDs7O1lBVlEsWUFBWTs7O3dCQWdCbEIsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDb21wb25lbnQsIElucHV0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBCcmVhZGNydW1iIH0gZnJvbSAnQHNwYXJ0YWN1cy9jb3JlJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IElDT05fVFlQRSB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2Ntcy1jb21wb25lbnRzL21pc2MvaWNvbi9pY29uLm1vZGVsJztcbmltcG9ydCB7IEZhY2V0TGlzdCB9IGZyb20gJy4uL2ZhY2V0Lm1vZGVsJztcbmltcG9ydCB7IEZhY2V0U2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2ZhY2V0LnNlcnZpY2UnO1xuXG4vKipcbiAqIEFjdGl2ZSBmYWNldHMgcmVuZGVyIHRoZSBhcHBsaWVkIGZhY2V0IHZhbHVlcyBhcyBhIGxpc3Qgb2YgZm9jdXNhYmxlIGJ1dHRvbnNcbiAqIHdoaWNoIGNhbiBiZSB1c2VkIHRvIHJlbW92ZSB0aGUgYXBwbGllZCBmYWNldCB2YWx1ZS5cbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnY3gtYWN0aXZlLWZhY2V0cycsXG4gIHRlbXBsYXRlVXJsOiAnLi9hY3RpdmUtZmFjZXRzLmNvbXBvbmVudC5odG1sJyxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5EZWZhdWx0LFxufSlcbmV4cG9ydCBjbGFzcyBBY3RpdmVGYWNldHNDb21wb25lbnQge1xuICAvKiogQWN0aXZlIGZhY2V0cyB3aGljaCBhcmUgYXBwbGllZCB0byB0aGUgcHJvZHVjdCByZXN1bHRzLiAqL1xuICBmYWNldExpc3QkOiBPYnNlcnZhYmxlPEZhY2V0TGlzdD4gPSB0aGlzLmZhY2V0U2VydmljZS5mYWNldExpc3QkO1xuXG4gIC8qKiBDb25maWd1cmFibGUgaWNvbiB3aGljaCBpcyB1c2VkIGZvciB0aGUgYWN0aXZlIGZhY2V0IGNsb3NlIGJ1dHRvbiAqL1xuICBASW5wdXQoKSBjbG9zZUljb24gPSBJQ09OX1RZUEUuQ0xPU0U7XG5cbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIGZhY2V0U2VydmljZTogRmFjZXRTZXJ2aWNlKSB7fVxuXG4gIGdldExpbmtQYXJhbXMoZmFjZXQ6IEJyZWFkY3J1bWIpIHtcbiAgICByZXR1cm4gdGhpcy5mYWNldFNlcnZpY2UuZ2V0TGlua1BhcmFtcyhmYWNldC5yZW1vdmVRdWVyeT8ucXVlcnk/LnZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgZm9jdXMga2V5IGlzIHVzZWQgdG8gcGVyc2lzdCB0aGUgZm9jdXMgb24gdGhlIGZhY2V0IHdoZW4gdGhlIERPTSBpcyBiZWluZ1xuICAgKiByZWNyZWF0ZWQuIFdlIG9ubHkgYXBwbHkgdGhlIGZvY3VzIGtleSBmb3IgdGhlIGdpdmVuIF9hY3RpdmVfIGZhY2V0IHdoZW4gdGhlcmVcbiAgICogdGhlIG9yaWdpbmFsIGZhY2V0cyBpcyBub3QgYXZhaWxhYmxlLiBUaGlzIGhhcHBlbnMgZm9yIG5vbiBtdWx0aS12YWx1ZWQgZmFjZXRzLlxuICAgKlxuICAgKiBXaXRoIHRoaXMgYXBwcm9hY2gsIHRoZSB3ZSBrZWVwIHRoZSBmb2N1cywgZWl0aGVyIGF0IHRoZSBmYWNldCBsaXN0IG9yIG9uIHRoZVxuICAgKiBhY3RpdmUgZmFjZXRzLlxuICAgKi9cbiAgZ2V0Rm9jdXNLZXkoZmFjZXRMaXN0OiBGYWNldExpc3QsIGZhY2V0OiBCcmVhZGNydW1iKSB7XG4gICAgcmV0dXJuIGZhY2V0TGlzdC5mYWNldHM/LmZpbmQoKGYpID0+XG4gICAgICBmLnZhbHVlcz8uZmluZCgodmFsKSA9PiB2YWwubmFtZSA9PT0gZmFjZXQuZmFjZXRWYWx1ZU5hbWUpXG4gICAgKVxuICAgICAgPyAnJ1xuICAgICAgOiBmYWNldC5mYWNldFZhbHVlTmFtZTtcbiAgfVxufVxuIl19