import { CheckoutActions } from './../actions/index';
export const initialState = {
    poNumber: { po: undefined, costCenter: undefined },
    address: {},
    deliveryMode: {
        supported: {},
        selected: '',
    },
    paymentDetails: {},
    orderDetails: {},
};
export function reducer(state = initialState, action) {
    switch (action.type) {
        case CheckoutActions.SET_PAYMENT_TYPE_SUCCESS: {
            const cart = action.payload;
            return Object.assign(Object.assign({}, state), { poNumber: Object.assign(Object.assign({}, state.poNumber), { po: cart.purchaseOrderNumber }) });
        }
        case CheckoutActions.SET_COST_CENTER_SUCCESS: {
            return Object.assign(Object.assign({}, state), { poNumber: Object.assign(Object.assign({}, state.poNumber), { costCenter: action.payload }) });
        }
        case CheckoutActions.ADD_DELIVERY_ADDRESS_SUCCESS:
        case CheckoutActions.SET_DELIVERY_ADDRESS_SUCCESS: {
            const address = action.payload;
            return Object.assign(Object.assign({}, state), { address });
        }
        case CheckoutActions.LOAD_SUPPORTED_DELIVERY_MODES_SUCCESS: {
            const supportedModes = action.payload;
            if (!supportedModes) {
                return state;
            }
            const supported = supportedModes.reduce((modes, mode) => {
                return Object.assign(Object.assign({}, modes), { [mode.code]: mode });
            }, Object.assign({}, state.deliveryMode.supported));
            return Object.assign(Object.assign({}, state), { deliveryMode: Object.assign(Object.assign({}, state.deliveryMode), { supported }) });
        }
        case CheckoutActions.SET_DELIVERY_MODE_SUCCESS: {
            const selected = action.payload;
            return Object.assign(Object.assign({}, state), { deliveryMode: Object.assign(Object.assign({}, state.deliveryMode), { selected }) });
        }
        case CheckoutActions.CREATE_PAYMENT_DETAILS_SUCCESS:
        case CheckoutActions.SET_PAYMENT_DETAILS_SUCCESS: {
            return Object.assign(Object.assign({}, state), { paymentDetails: action.payload });
        }
        case CheckoutActions.CREATE_PAYMENT_DETAILS_FAIL: {
            const paymentDetails = action.payload;
            if (paymentDetails['hasError']) {
                return Object.assign(Object.assign({}, state), { paymentDetails });
            }
            return state;
        }
        case CheckoutActions.PLACE_ORDER_SUCCESS:
        case CheckoutActions.SCHEDULE_REPLENISHMENT_ORDER_SUCCESS: {
            const orderDetails = action.payload;
            return Object.assign(Object.assign({}, state), { orderDetails });
        }
        case CheckoutActions.CLEAR_CHECKOUT_DATA: {
            return initialState;
        }
        case CheckoutActions.CLEAR_CHECKOUT_STEP: {
            const stepNumber = action.payload;
            switch (stepNumber) {
                case 1: {
                    return Object.assign(Object.assign({}, state), { address: {} });
                }
                case 2: {
                    return Object.assign(Object.assign({}, state), { deliveryMode: Object.assign(Object.assign({}, state.deliveryMode), { supported: {}, selected: '' }) });
                }
                case 3: {
                    return Object.assign(Object.assign({}, state), { paymentDetails: {} });
                }
            }
            return state;
        }
        case CheckoutActions.CLEAR_SUPPORTED_DELIVERY_MODES:
        case CheckoutActions.CHECKOUT_CLEAR_MISCS_DATA: {
            return Object.assign(Object.assign({}, state), { deliveryMode: Object.assign(Object.assign({}, state.deliveryMode), { supported: {} }) });
        }
        case CheckoutActions.LOAD_CHECKOUT_DETAILS_SUCCESS: {
            return Object.assign(Object.assign({}, state), { address: action.payload.deliveryAddress, deliveryMode: Object.assign(Object.assign({}, state.deliveryMode), { selected: action.payload.deliveryMode && action.payload.deliveryMode.code }), paymentDetails: action.payload.paymentInfo });
        }
        case CheckoutActions.CLEAR_CHECKOUT_DELIVERY_ADDRESS: {
            return Object.assign(Object.assign({}, state), { address: {} });
        }
        case CheckoutActions.CLEAR_CHECKOUT_DELIVERY_MODE: {
            return Object.assign(Object.assign({}, state), { deliveryMode: Object.assign(Object.assign({}, state.deliveryMode), { selected: '' }) });
        }
    }
    return state;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hlY2tvdXQucmVkdWNlci5qcyIsInNvdXJjZVJvb3QiOiJDOi9Vc2Vycy9QYXRyeWsvRGVza3RvcC9zcGFydGFjdXMvcHJvamVjdHMvY29yZS8iLCJzb3VyY2VzIjpbInNyYy9jaGVja291dC9zdG9yZS9yZWR1Y2Vycy9jaGVja291dC5yZWR1Y2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUtBLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUVyRCxNQUFNLENBQUMsTUFBTSxZQUFZLEdBQXVCO0lBQzlDLFFBQVEsRUFBRSxFQUFFLEVBQUUsRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRTtJQUNsRCxPQUFPLEVBQUUsRUFBRTtJQUNYLFlBQVksRUFBRTtRQUNaLFNBQVMsRUFBRSxFQUFFO1FBQ2IsUUFBUSxFQUFFLEVBQUU7S0FDYjtJQUNELGNBQWMsRUFBRSxFQUFFO0lBQ2xCLFlBQVksRUFBRSxFQUFFO0NBQ2pCLENBQUM7QUFFRixNQUFNLFVBQVUsT0FBTyxDQUNyQixLQUFLLEdBQUcsWUFBWSxFQUNwQixNQUk2QztJQUU3QyxRQUFRLE1BQU0sQ0FBQyxJQUFJLEVBQUU7UUFDbkIsS0FBSyxlQUFlLENBQUMsd0JBQXdCLENBQUMsQ0FBQztZQUM3QyxNQUFNLElBQUksR0FBUyxNQUFNLENBQUMsT0FBTyxDQUFDO1lBQ2xDLHVDQUNLLEtBQUssS0FDUixRQUFRLGtDQUNILEtBQUssQ0FBQyxRQUFRLEtBQ2pCLEVBQUUsRUFBRSxJQUFJLENBQUMsbUJBQW1CLE9BRTlCO1NBQ0g7UUFFRCxLQUFLLGVBQWUsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1lBQzVDLHVDQUNLLEtBQUssS0FDUixRQUFRLGtDQUNILEtBQUssQ0FBQyxRQUFRLEtBQ2pCLFVBQVUsRUFBRSxNQUFNLENBQUMsT0FBTyxPQUU1QjtTQUNIO1FBRUQsS0FBSyxlQUFlLENBQUMsNEJBQTRCLENBQUM7UUFDbEQsS0FBSyxlQUFlLENBQUMsNEJBQTRC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LGtDQUNQLEtBQUssQ0FBQyxZQUFZLEtBQ3JCLFFBQVEsRUFDTixNQUFNLENBQUMsT0FBTyxDQUFDLFlBQVksSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxJQUFJLEtBRW5FLGNBQWMsRUFBRSxNQUFNLENBQUMsT0FBTyxDQUFDLFdBQVcsSUFDMUM7U0FDSDtRQUVELEtBQUssZUFBZSxDQUFDLCtCQUErQixDQUFDLENBQUM7WUFDcEQsdUNBQ0ssS0FBSyxLQUNSLE9BQU8sRUFBRSxFQUFFLElBQ1g7U0FDSDtRQUVELEtBQUssZUFBZSxDQUFDLDRCQUE0QixDQUFDLENBQUM7WUFDakQsdUNBQ0ssS0FBSyxLQUNSLFlBQVksa0NBQ1AsS0FBSyxDQUFDLFlBQVksS0FDckIsUUFBUSxFQUFFLEVBQUUsT0FFZDtTQUNIO0tBQ0Y7SUFFRCxPQUFPLEtBQUssQ0FBQztBQUNmLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBZGRyZXNzIH0gZnJvbSAnLi4vLi4vLi4vbW9kZWwvYWRkcmVzcy5tb2RlbCc7XG5pbXBvcnQgeyBDYXJ0IH0gZnJvbSAnLi4vLi4vLi4vbW9kZWwvY2FydC5tb2RlbCc7XG5pbXBvcnQgeyBEZWxpdmVyeU1vZGUsIE9yZGVyIH0gZnJvbSAnLi4vLi4vLi4vbW9kZWwvb3JkZXIubW9kZWwnO1xuaW1wb3J0IHsgUmVwbGVuaXNobWVudE9yZGVyIH0gZnJvbSAnLi4vLi4vLi4vbW9kZWwvcmVwbGVuaXNobWVudC1vcmRlci5tb2RlbCc7XG5pbXBvcnQgeyBDaGVja291dFN0ZXBzU3RhdGUgfSBmcm9tICcuLi9jaGVja291dC1zdGF0ZSc7XG5pbXBvcnQgeyBDaGVja291dEFjdGlvbnMgfSBmcm9tICcuLy4uL2FjdGlvbnMvaW5kZXgnO1xuXG5leHBvcnQgY29uc3QgaW5pdGlhbFN0YXRlOiBDaGVja291dFN0ZXBzU3RhdGUgPSB7XG4gIHBvTnVtYmVyOiB7IHBvOiB1bmRlZmluZWQsIGNvc3RDZW50ZXI6IHVuZGVmaW5lZCB9LFxuICBhZGRyZXNzOiB7fSxcbiAgZGVsaXZlcnlNb2RlOiB7XG4gICAgc3VwcG9ydGVkOiB7fSxcbiAgICBzZWxlY3RlZDogJycsXG4gIH0sXG4gIHBheW1lbnREZXRhaWxzOiB7fSxcbiAgb3JkZXJEZXRhaWxzOiB7fSxcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiByZWR1Y2VyKFxuICBzdGF0ZSA9IGluaXRpYWxTdGF0ZSxcbiAgYWN0aW9uOlxuICAgIHwgQ2hlY2tvdXRBY3Rpb25zLkNoZWNrb3V0QWN0aW9uXG4gICAgfCBDaGVja291dEFjdGlvbnMuQ2hlY2tvdXRDbGVhck1pc2NzRGF0YVxuICAgIHwgQ2hlY2tvdXRBY3Rpb25zLlNldFBheW1lbnRUeXBlU3VjY2Vzc1xuICAgIHwgQ2hlY2tvdXRBY3Rpb25zLlJlcGxlbmlzaG1lbnRPcmRlckFjdGlvbnNcbik6IENoZWNrb3V0U3RlcHNTdGF0ZSB7XG4gIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICBjYXNlIENoZWNrb3V0QWN0aW9ucy5TRVRfUEFZTUVOVF9UWVBFX1NVQ0NFU1M6IHtcbiAgICAgIGNvbnN0IGNhcnQ6IENhcnQgPSBhY3Rpb24ucGF5bG9hZDtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnN0YXRlLFxuICAgICAgICBwb051bWJlcjoge1xuICAgICAgICAgIC4uLnN0YXRlLnBvTnVtYmVyLFxuICAgICAgICAgIHBvOiBjYXJ0LnB1cmNoYXNlT3JkZXJOdW1iZXIsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNhc2UgQ2hlY2tvdXRBY3Rpb25zLlNFVF9DT1NUX0NFTlRFUl9TVUNDRVNTOiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgcG9OdW1iZXI6IHtcbiAgICAgICAgICAuLi5zdGF0ZS5wb051bWJlcixcbiAgICAgICAgICBjb3N0Q2VudGVyOiBhY3Rpb24ucGF5bG9hZCxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY2FzZSBDaGVja291dEFjdGlvbnMuQUREX0RFTElWRVJZX0FERFJFU1NfU1VDQ0VTUzpcbiAgICBjYXNlIENoZWNrb3V0QWN0aW9ucy5TRVRfREVMSVZFUllfQUREUkVTU19TVUNDRVNTOiB7XG4gICAgICBjb25zdCBhZGRyZXNzOiBBZGRyZXNzID0gYWN0aW9uLnBheWxvYWQ7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnN0YXRlLFxuICAgICAgICBhZGRyZXNzLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjYXNlIENoZWNrb3V0QWN0aW9ucy5MT0FEX1NVUFBPUlRFRF9ERUxJVkVSWV9NT0RFU19TVUNDRVNTOiB7XG4gICAgICBjb25zdCBzdXBwb3J0ZWRNb2RlcyA9IGFjdGlvbi5wYXlsb2FkO1xuICAgICAgaWYgKCFzdXBwb3J0ZWRNb2Rlcykge1xuICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHN1cHBvcnRlZCA9IHN1cHBvcnRlZE1vZGVzLnJlZHVjZShcbiAgICAgICAgKG1vZGVzOiB7IFtjb2RlOiBzdHJpbmddOiBEZWxpdmVyeU1vZGUgfSwgbW9kZTogRGVsaXZlcnlNb2RlKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLm1vZGVzLFxuICAgICAgICAgICAgW21vZGUuY29kZV06IG1vZGUsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIC4uLnN0YXRlLmRlbGl2ZXJ5TW9kZS5zdXBwb3J0ZWQsXG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnN0YXRlLFxuICAgICAgICBkZWxpdmVyeU1vZGU6IHtcbiAgICAgICAgICAuLi5zdGF0ZS5kZWxpdmVyeU1vZGUsXG4gICAgICAgICAgc3VwcG9ydGVkLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjYXNlIENoZWNrb3V0QWN0aW9ucy5TRVRfREVMSVZFUllfTU9ERV9TVUNDRVNTOiB7XG4gICAgICBjb25zdCBzZWxlY3RlZCA9IGFjdGlvbi5wYXlsb2FkO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgZGVsaXZlcnlNb2RlOiB7XG4gICAgICAgICAgLi4uc3RhdGUuZGVsaXZlcnlNb2RlLFxuICAgICAgICAgIHNlbGVjdGVkLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjYXNlIENoZWNrb3V0QWN0aW9ucy5DUkVBVEVfUEFZTUVOVF9ERVRBSUxTX1NVQ0NFU1M6XG4gICAgY2FzZSBDaGVja291dEFjdGlvbnMuU0VUX1BBWU1FTlRfREVUQUlMU19TVUNDRVNTOiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgcGF5bWVudERldGFpbHM6IGFjdGlvbi5wYXlsb2FkLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjYXNlIENoZWNrb3V0QWN0aW9ucy5DUkVBVEVfUEFZTUVOVF9ERVRBSUxTX0ZBSUw6IHtcbiAgICAgIGNvbnN0IHBheW1lbnREZXRhaWxzID0gYWN0aW9uLnBheWxvYWQ7XG4gICAgICBpZiAocGF5bWVudERldGFpbHNbJ2hhc0Vycm9yJ10pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgICBwYXltZW50RGV0YWlscyxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH1cblxuICAgIGNhc2UgQ2hlY2tvdXRBY3Rpb25zLlBMQUNFX09SREVSX1NVQ0NFU1M6XG4gICAgY2FzZSBDaGVja291dEFjdGlvbnMuU0NIRURVTEVfUkVQTEVOSVNITUVOVF9PUkRFUl9TVUNDRVNTOiB7XG4gICAgICBjb25zdCBvcmRlckRldGFpbHM6IE9yZGVyIHwgUmVwbGVuaXNobWVudE9yZGVyID0gYWN0aW9uLnBheWxvYWQ7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnN0YXRlLFxuICAgICAgICBvcmRlckRldGFpbHMsXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNhc2UgQ2hlY2tvdXRBY3Rpb25zLkNMRUFSX0NIRUNLT1VUX0RBVEE6IHtcbiAgICAgIHJldHVybiBpbml0aWFsU3RhdGU7XG4gICAgfVxuXG4gICAgY2FzZSBDaGVja291dEFjdGlvbnMuQ0xFQVJfQ0hFQ0tPVVRfU1RFUDoge1xuICAgICAgY29uc3Qgc3RlcE51bWJlciA9IGFjdGlvbi5wYXlsb2FkO1xuICAgICAgc3dpdGNoIChzdGVwTnVtYmVyKSB7XG4gICAgICAgIGNhc2UgMToge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgICAgIGFkZHJlc3M6IHt9LFxuICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjYXNlIDI6IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgICBkZWxpdmVyeU1vZGU6IHtcbiAgICAgICAgICAgICAgLi4uc3RhdGUuZGVsaXZlcnlNb2RlLFxuICAgICAgICAgICAgICBzdXBwb3J0ZWQ6IHt9LFxuICAgICAgICAgICAgICBzZWxlY3RlZDogJycsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjYXNlIDM6IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgICBwYXltZW50RGV0YWlsczoge30sXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gc3RhdGU7XG4gICAgfVxuXG4gICAgY2FzZSBDaGVja291dEFjdGlvbnMuQ0xFQVJfU1VQUE9SVEVEX0RFTElWRVJZX01PREVTOlxuICAgIGNhc2UgQ2hlY2tvdXRBY3Rpb25zLkNIRUNLT1VUX0NMRUFSX01JU0NTX0RBVEE6IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnN0YXRlLFxuICAgICAgICBkZWxpdmVyeU1vZGU6IHtcbiAgICAgICAgICAuLi5zdGF0ZS5kZWxpdmVyeU1vZGUsXG4gICAgICAgICAgc3VwcG9ydGVkOiB7fSxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuICAgIGNhc2UgQ2hlY2tvdXRBY3Rpb25zLkxPQURfQ0hFQ0tPVVRfREVUQUlMU19TVUNDRVNTOiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgYWRkcmVzczogYWN0aW9uLnBheWxvYWQuZGVsaXZlcnlBZGRyZXNzLFxuICAgICAgICBkZWxpdmVyeU1vZGU6IHtcbiAgICAgICAgICAuLi5zdGF0ZS5kZWxpdmVyeU1vZGUsXG4gICAgICAgICAgc2VsZWN0ZWQ6XG4gICAgICAgICAgICBhY3Rpb24ucGF5bG9hZC5kZWxpdmVyeU1vZGUgJiYgYWN0aW9uLnBheWxvYWQuZGVsaXZlcnlNb2RlLmNvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIHBheW1lbnREZXRhaWxzOiBhY3Rpb24ucGF5bG9hZC5wYXltZW50SW5mbyxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY2FzZSBDaGVja291dEFjdGlvbnMuQ0xFQVJfQ0hFQ0tPVVRfREVMSVZFUllfQUREUkVTUzoge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGFkZHJlc3M6IHt9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjYXNlIENoZWNrb3V0QWN0aW9ucy5DTEVBUl9DSEVDS09VVF9ERUxJVkVSWV9NT0RFOiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgZGVsaXZlcnlNb2RlOiB7XG4gICAgICAgICAgLi4uc3RhdGUuZGVsaXZlcnlNb2RlLFxuICAgICAgICAgIHNlbGVjdGVkOiAnJyxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHN0YXRlO1xufVxuIl19