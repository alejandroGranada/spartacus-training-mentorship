import { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { SAVE_CART_NORMALIZER } from '../../../cart/connectors/save-cart/converters';
import { ConverterService } from '../../../util/converter.service';
import { OccEndpointsService } from '../../services/occ-endpoints.service';
/**
 * TODO(#11938): 4.0: use OccSavedCartAdapter instead from saved-cart feature-lib of cart
 *
 * When the saved cart feature module exist, there exist a race condition between the 'saveCart' key for the default occ config
 * Allows wishlist to function when the key value is pulled from the saved-cart feature-lib
 *
 * Keep in mind that this adapter will be removed in 4.0 as we will delegate this functionality to the saved-cart feature-lib
 **/
export class OccSaveCartAdapter {
    constructor(http, occEndpointsService, converterService) {
        this.http = http;
        this.occEndpointsService = occEndpointsService;
        this.converterService = converterService;
    }
    saveCart(userId, cartId, saveCartName, saveCartDescription) {
        let httpParams = new HttpParams();
        if (Boolean(saveCartName)) {
            httpParams = httpParams.set('saveCartName', saveCartName);
        }
        if (Boolean(saveCartDescription)) {
            httpParams = httpParams.set('saveCartDescription', saveCartDescription);
        }
        const headers = new HttpHeaders({
            'Content-Type': 'application/x-www-form-urlencoded',
        });
        return !this.occEndpointsService
            .getUrl('saveCart', { userId, cartId })
            .includes('saveCartName')
            ? this.http
                .patch(this.occEndpointsService.getUrl('saveCart', { userId, cartId }), httpParams, { headers })
                .pipe(this.converterService.pipeable(SAVE_CART_NORMALIZER))
            : this.http
                .patch(this.occEndpointsService.getUrl('saveCart', {
                userId,
                cartId,
                saveCartName,
                saveCartDescription,
            }), cartId)
                .pipe(this.converterService.pipeable(SAVE_CART_NORMALIZER));
    }
}
OccSaveCartAdapter.decorators = [
    { type: Injectable }
];
OccSaveCartAdapter.ctorParameters = () => [
    { type: HttpClient },
    { type: OccEndpointsService },
    { type: ConverterService }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2NjLXNhdmUtY2FydC5hZGFwdGVyLmpzIiwic291cmNlUm9vdCI6IkM6L1VzZXJzL1BhdHJ5ay9EZXNrdG9wL3NwYXJ0YWN1cy9wcm9qZWN0cy9jb3JlLyIsInNvdXJjZXMiOlsic3JjL29jYy9hZGFwdGVycy9jYXJ0L29jYy1zYXZlLWNhcnQuYWRhcHRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBRSxVQUFVLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUMzRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTNDLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLCtDQUErQyxDQUFDO0FBR3JGLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGlDQUFpQyxDQUFDO0FBRW5FLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHNDQUFzQyxDQUFDO0FBRTNFOzs7Ozs7O0lBT0k7QUFFSixNQUFNLE9BQU8sa0JBQWtCO0lBQzdCLFlBQ1ksSUFBZ0IsRUFDaEIsbUJBQXdDLEVBQ3hDLGdCQUFrQztRQUZsQyxTQUFJLEdBQUosSUFBSSxDQUFZO1FBQ2hCLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBcUI7UUFDeEMscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFrQjtJQUMzQyxDQUFDO0lBRUcsUUFBUSxDQUNiLE1BQWMsRUFDZCxNQUFjLEVBQ2QsWUFBcUIsRUFDckIsbUJBQTRCO1FBRTVCLElBQUksVUFBVSxHQUFHLElBQUksVUFBVSxFQUFFLENBQUM7UUFFbEMsSUFBSSxPQUFPLENBQUMsWUFBWSxDQUFDLEVBQUU7WUFDekIsVUFBVSxHQUFHLFVBQVUsQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLFlBQVksQ0FBQyxDQUFDO1NBQzNEO1FBRUQsSUFBSSxPQUFPLENBQUMsbUJBQW1CLENBQUMsRUFBRTtZQUNoQyxVQUFVLEdBQUcsVUFBVSxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO1NBQ3pFO1FBRUQsTUFBTSxPQUFPLEdBQUcsSUFBSSxXQUFXLENBQUM7WUFDOUIsY0FBYyxFQUFFLG1DQUFtQztTQUNwRCxDQUFDLENBQUM7UUFFSCxPQUFPLENBQUMsSUFBSSxDQUFDLG1CQUFtQjthQUM3QixNQUFNLENBQUMsVUFBVSxFQUFFLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxDQUFDO2FBQ3RDLFFBQVEsQ0FBQyxjQUFjLENBQUM7WUFDekIsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJO2lCQUNOLEtBQUssQ0FDSixJQUFJLENBQUMsbUJBQW1CLENBQUMsTUFBTSxDQUFDLFVBQVUsRUFBRSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsQ0FBQyxFQUMvRCxVQUFVLEVBQ1YsRUFBRSxPQUFPLEVBQUUsQ0FDWjtpQkFDQSxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1lBQy9ELENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSTtpQkFDTixLQUFLLENBQ0osSUFBSSxDQUFDLG1CQUFtQixDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUU7Z0JBQzFDLE1BQU07Z0JBQ04sTUFBTTtnQkFDTixZQUFZO2dCQUNaLG1CQUFtQjthQUNwQixDQUFDLEVBQ0YsTUFBTSxDQUNQO2lCQUNBLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLG9CQUFvQixDQUFDLENBQUMsQ0FBQztJQUNwRSxDQUFDOzs7WUFqREYsVUFBVTs7O1lBbEJGLFVBQVU7WUFRVixtQkFBbUI7WUFGbkIsZ0JBQWdCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSHR0cENsaWVudCwgSHR0cEhlYWRlcnMsIEh0dHBQYXJhbXMgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBTQVZFX0NBUlRfTk9STUFMSVpFUiB9IGZyb20gJy4uLy4uLy4uL2NhcnQvY29ubmVjdG9ycy9zYXZlLWNhcnQvY29udmVydGVycyc7XG5pbXBvcnQgeyBTYXZlQ2FydEFkYXB0ZXIgfSBmcm9tICcuLi8uLi8uLi9jYXJ0L2Nvbm5lY3RvcnMvc2F2ZS1jYXJ0L3NhdmUtY2FydC5hZGFwdGVyJztcbmltcG9ydCB7IFNhdmVDYXJ0UmVzdWx0IH0gZnJvbSAnLi4vLi4vLi4vbW9kZWwvY2FydC5tb2RlbCc7XG5pbXBvcnQgeyBDb252ZXJ0ZXJTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vdXRpbC9jb252ZXJ0ZXIuc2VydmljZSc7XG5pbXBvcnQgeyBPY2MgfSBmcm9tICcuLi8uLi9vY2MtbW9kZWxzL29jYy5tb2RlbHMnO1xuaW1wb3J0IHsgT2NjRW5kcG9pbnRzU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL29jYy1lbmRwb2ludHMuc2VydmljZSc7XG5cbi8qKlxuICogVE9ETygjMTE5MzgpOiA0LjA6IHVzZSBPY2NTYXZlZENhcnRBZGFwdGVyIGluc3RlYWQgZnJvbSBzYXZlZC1jYXJ0IGZlYXR1cmUtbGliIG9mIGNhcnRcbiAqXG4gKiBXaGVuIHRoZSBzYXZlZCBjYXJ0IGZlYXR1cmUgbW9kdWxlIGV4aXN0LCB0aGVyZSBleGlzdCBhIHJhY2UgY29uZGl0aW9uIGJldHdlZW4gdGhlICdzYXZlQ2FydCcga2V5IGZvciB0aGUgZGVmYXVsdCBvY2MgY29uZmlnXG4gKiBBbGxvd3Mgd2lzaGxpc3QgdG8gZnVuY3Rpb24gd2hlbiB0aGUga2V5IHZhbHVlIGlzIHB1bGxlZCBmcm9tIHRoZSBzYXZlZC1jYXJ0IGZlYXR1cmUtbGliXG4gKlxuICogS2VlcCBpbiBtaW5kIHRoYXQgdGhpcyBhZGFwdGVyIHdpbGwgYmUgcmVtb3ZlZCBpbiA0LjAgYXMgd2Ugd2lsbCBkZWxlZ2F0ZSB0aGlzIGZ1bmN0aW9uYWxpdHkgdG8gdGhlIHNhdmVkLWNhcnQgZmVhdHVyZS1saWJcbiAqKi9cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBPY2NTYXZlQ2FydEFkYXB0ZXIgaW1wbGVtZW50cyBTYXZlQ2FydEFkYXB0ZXIge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcm90ZWN0ZWQgaHR0cDogSHR0cENsaWVudCxcbiAgICBwcm90ZWN0ZWQgb2NjRW5kcG9pbnRzU2VydmljZTogT2NjRW5kcG9pbnRzU2VydmljZSxcbiAgICBwcm90ZWN0ZWQgY29udmVydGVyU2VydmljZTogQ29udmVydGVyU2VydmljZVxuICApIHt9XG5cbiAgcHVibGljIHNhdmVDYXJ0KFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIGNhcnRJZDogc3RyaW5nLFxuICAgIHNhdmVDYXJ0TmFtZT86IHN0cmluZyxcbiAgICBzYXZlQ2FydERlc2NyaXB0aW9uPzogc3RyaW5nXG4gICk6IE9ic2VydmFibGU8U2F2ZUNhcnRSZXN1bHQ+IHtcbiAgICBsZXQgaHR0cFBhcmFtcyA9IG5ldyBIdHRwUGFyYW1zKCk7XG5cbiAgICBpZiAoQm9vbGVhbihzYXZlQ2FydE5hbWUpKSB7XG4gICAgICBodHRwUGFyYW1zID0gaHR0cFBhcmFtcy5zZXQoJ3NhdmVDYXJ0TmFtZScsIHNhdmVDYXJ0TmFtZSk7XG4gICAgfVxuXG4gICAgaWYgKEJvb2xlYW4oc2F2ZUNhcnREZXNjcmlwdGlvbikpIHtcbiAgICAgIGh0dHBQYXJhbXMgPSBodHRwUGFyYW1zLnNldCgnc2F2ZUNhcnREZXNjcmlwdGlvbicsIHNhdmVDYXJ0RGVzY3JpcHRpb24pO1xuICAgIH1cblxuICAgIGNvbnN0IGhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoe1xuICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuICF0aGlzLm9jY0VuZHBvaW50c1NlcnZpY2VcbiAgICAgIC5nZXRVcmwoJ3NhdmVDYXJ0JywgeyB1c2VySWQsIGNhcnRJZCB9KVxuICAgICAgLmluY2x1ZGVzKCdzYXZlQ2FydE5hbWUnKVxuICAgICAgPyB0aGlzLmh0dHBcbiAgICAgICAgICAucGF0Y2g8T2NjLlNhdmVDYXJ0UmVzdWx0PihcbiAgICAgICAgICAgIHRoaXMub2NjRW5kcG9pbnRzU2VydmljZS5nZXRVcmwoJ3NhdmVDYXJ0JywgeyB1c2VySWQsIGNhcnRJZCB9KSxcbiAgICAgICAgICAgIGh0dHBQYXJhbXMsXG4gICAgICAgICAgICB7IGhlYWRlcnMgfVxuICAgICAgICAgIClcbiAgICAgICAgICAucGlwZSh0aGlzLmNvbnZlcnRlclNlcnZpY2UucGlwZWFibGUoU0FWRV9DQVJUX05PUk1BTElaRVIpKVxuICAgICAgOiB0aGlzLmh0dHBcbiAgICAgICAgICAucGF0Y2g8T2NjLlNhdmVDYXJ0UmVzdWx0PihcbiAgICAgICAgICAgIHRoaXMub2NjRW5kcG9pbnRzU2VydmljZS5nZXRVcmwoJ3NhdmVDYXJ0Jywge1xuICAgICAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgICAgIGNhcnRJZCxcbiAgICAgICAgICAgICAgc2F2ZUNhcnROYW1lLFxuICAgICAgICAgICAgICBzYXZlQ2FydERlc2NyaXB0aW9uLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBjYXJ0SWRcbiAgICAgICAgICApXG4gICAgICAgICAgLnBpcGUodGhpcy5jb252ZXJ0ZXJTZXJ2aWNlLnBpcGVhYmxlKFNBVkVfQ0FSVF9OT1JNQUxJWkVSKSk7XG4gIH1cbn1cbiJdfQ==